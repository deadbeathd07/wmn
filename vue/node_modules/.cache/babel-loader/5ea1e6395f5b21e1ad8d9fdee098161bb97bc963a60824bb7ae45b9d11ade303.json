{"ast":null,"code":"import { onBeforeMount, ref, watch } from 'vue';\nimport appBridge from './mixins/app-bridge';\nimport goBack from './mixins/go-back';\nimport ItserveLoader from '@/components/content/ItserveLoader';\nimport { useStore } from 'vuex';\nimport { computed } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useI18n } from 'vue-i18n';\nexport default {\n  __name: 'App',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    var store = useStore();\n    var route = useRoute();\n    var router = useRouter();\n    var i18n = useI18n();\n    var nativeData = computed(() => store.state.Auth.nativeData);\n    var showLoader = computed(() => store.state.Api.loading);\n    var locale = computed(() => store.state.Auth.locale);\n    var appTheme = computed(() => store.state.Auth.nativeData.themeMode);\n    var authToken = computed(() => store.state.Auth.authToken);\n    var entry = ref(store.state.Settings.entry);\n    var calendar = computed(() => store.state.Auth.calendar);\n\n    // This authData and authentificate of it below are necessary for entry in browser (for developing)\n    var authData = {\n      uid: '734656345683485',\n      firebase_token: 'aaaaaaaaaaaaaa',\n      theme_mode: 'dark',\n      lang: 'en',\n      google_id_token: '',\n      google_access_token: '',\n      platform: 'ios',\n      apple_user_id: '',\n      agreement: false\n    };\n    store.dispatch('Auth/authenticate', authData);\n    console.log('app setting', JSON.stringify(nativeData.value));\n    onBeforeMount(() => {\n      document.body.classList.add('dark'); //can be removed, couse\n    });\n\n    appBridge.methods.nativeWaitForEvent('authToken', authData => {\n      store.dispatch('Auth/authenticate', authData);\n      nativeData.value = authData;\n      store.dispatch('Auth/newGoogleAuth');\n      console.log('native set auth', JSON.stringify(nativeData.value));\n      // if(store.dispatch(\"Auth/authenticate\", authData)) {\n      //   appBridge.methods.nativeSendEvent(\"preloadInterstitial\");\n      // }\n      // if (nativeData.google_id_token.length > 0 || nativeData.google_access_token.length > 0 || nativeData.apple_user_id.length > 0) {\n      //   appBridge.methods.nativeSendEvent(\"preloadInterstitial\");\n      // }\n    });\n\n    appBridge.methods.nativeWaitForEvent('authTokenListen', authData => {\n      store.dispatch('Auth/authenticate', authData);\n      nativeData.value = authData;\n      store.dispatch('Auth/newGoogleAuth');\n      console.log('native listen auth', JSON.stringify(nativeData.value));\n    });\n\n    // appBridge.methods.nativeWaitForEvent('backButton', () => {\n    // \tif (route.name === 'HomeView') {\n    // \t\tappBridge.methods.nativeSendEvent('setPageLevel', { level: 0 });\n    // \t} else {\n    // \t\tappBridge.methods.nativeSendEvent('setPageLevel', { level: 1 });\n    // \t\tgoBack.methods.goBack();\n    // \t}\n    // });\n\n    // appBridge.methods.nativeWaitForEvent('deepLink', deepLinkData => {\n    // \trouter.push(deepLinkData);\n    // });\n\n    watch(authToken, () => {\n      console.log('watch auth');\n      store.dispatch('Settings/getEntry');\n      store.dispatch('Auth/getQuestions', locale.value);\n    });\n    watch(locale, (newLocale, oldLocale) => {\n      console.log('watch locale');\n      i18n.locale.value = newLocale;\n      store.dispatch('Auth/getQuestions', newLocale);\n    });\n    watch(nativeData, () => {\n      console.log('watch native');\n      console.log(entry.value);\n      // if (nativeData.value && entry.value) {\n      // \trouter.push({ name: 'QuestionsView' });\n      // } else if (nativeData.value && !nativeData.value.google_access_token) {\n      // \trouter.push({ name: 'AuthorizationView' });\n      // } else {\n      // \trouter.push({ name: 'HomeView' });\n      // }\n    });\n\n    async function clearForGoogleAuth({\n      commit\n    }) {\n      await commit('Auth/SET_NATIVE_DATA', null);\n    }\n    var __returned__ = {\n      store,\n      route,\n      router,\n      i18n,\n      nativeData,\n      showLoader,\n      locale,\n      appTheme,\n      authToken,\n      entry,\n      calendar,\n      get authData() {\n        return authData;\n      },\n      set authData(v) {\n        authData = v;\n      },\n      clearForGoogleAuth,\n      onBeforeMount,\n      ref,\n      watch,\n      get appBridge() {\n        return appBridge;\n      },\n      get goBack() {\n        return goBack;\n      },\n      get ItserveLoader() {\n        return ItserveLoader;\n      },\n      get useStore() {\n        return useStore;\n      },\n      computed,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get useI18n() {\n        return useI18n;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onBeforeMount","ref","watch","appBridge","goBack","ItserveLoader","useStore","computed","useRoute","useRouter","useI18n","store","route","router","i18n","nativeData","state","Auth","showLoader","Api","loading","locale","appTheme","themeMode","authToken","entry","Settings","calendar","authData","uid","firebase_token","theme_mode","lang","google_id_token","google_access_token","platform","apple_user_id","agreement","dispatch","console","log","JSON","stringify","value","document","body","classList","add","methods","nativeWaitForEvent","newLocale","oldLocale","clearForGoogleAuth","commit"],"sources":["D:/working/wmn-calendar.itserve.es/src/App.vue"],"sourcesContent":["<template>\r\n\t<van-row\r\n\t\tclass=\"h-full bg-no-repeat bg-clip-border bg-origin-border bg-center bg-cover\"\r\n\t\tjustify=\"center\"\r\n\t>\r\n\t\t<van-col span=\"24\" class=\"h-full\">\r\n\t\t\t<ItserveLoader :show=\"showLoader\" />\r\n\t\t\t<div v-if=\"!nativeData\">Loading</div>\r\n\t\t\t<router-view v-else />\r\n\t\t</van-col>\r\n\t</van-row>\r\n</template>\r\n<script setup>\r\nimport { onBeforeMount, ref, watch } from 'vue';\r\nimport appBridge from './mixins/app-bridge';\r\nimport goBack from './mixins/go-back';\r\nimport ItserveLoader from '@/components/content/ItserveLoader';\r\nimport { useStore } from 'vuex';\r\nimport { computed } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { useI18n } from 'vue-i18n';\r\n\r\nconst store = useStore();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst i18n = useI18n();\r\n\r\nconst nativeData = computed(() => store.state.Auth.nativeData);\r\nconst showLoader = computed(() => store.state.Api.loading);\r\nconst locale = computed(() => store.state.Auth.locale);\r\nconst appTheme = computed(() => store.state.Auth.nativeData.themeMode);\r\nconst authToken = computed(() => store.state.Auth.authToken);\r\nconst entry = ref(store.state.Settings.entry);\r\nconst calendar = computed(() => store.state.Auth.calendar);\r\n\r\n// This authData and authentificate of it below are necessary for entry in browser (for developing)\r\nlet authData = {\r\n\tuid: '734656345683485',\r\n\tfirebase_token: 'aaaaaaaaaaaaaa',\r\n\ttheme_mode: 'dark',\r\n\tlang: 'en',\r\n\tgoogle_id_token: '',\r\n\tgoogle_access_token: '',\r\n\tplatform: 'ios',\r\n\tapple_user_id: '',\r\n\tagreement: false,\r\n};\r\n\r\nstore.dispatch('Auth/authenticate', authData);\r\n\r\nconsole.log('app setting', JSON.stringify(nativeData.value));\r\n\r\nonBeforeMount(() => {\r\n\tdocument.body.classList.add('dark'); //can be removed, couse\r\n});\r\n\r\nappBridge.methods.nativeWaitForEvent('authToken', authData => {\r\n\tstore.dispatch('Auth/authenticate', authData);\r\n\tnativeData.value = authData;\r\n\tstore.dispatch('Auth/newGoogleAuth');\r\n\tconsole.log('native set auth', JSON.stringify(nativeData.value));\r\n\t// if(store.dispatch(\"Auth/authenticate\", authData)) {\r\n\t//   appBridge.methods.nativeSendEvent(\"preloadInterstitial\");\r\n\t// }\r\n\t// if (nativeData.google_id_token.length > 0 || nativeData.google_access_token.length > 0 || nativeData.apple_user_id.length > 0) {\r\n\t//   appBridge.methods.nativeSendEvent(\"preloadInterstitial\");\r\n\t// }\r\n});\r\n\r\nappBridge.methods.nativeWaitForEvent('authTokenListen', authData => {\r\n\tstore.dispatch('Auth/authenticate', authData);\r\n\tnativeData.value = authData;\r\n\tstore.dispatch('Auth/newGoogleAuth');\r\n\tconsole.log('native listen auth', JSON.stringify(nativeData.value));\r\n});\r\n\r\n// appBridge.methods.nativeWaitForEvent('backButton', () => {\r\n// \tif (route.name === 'HomeView') {\r\n// \t\tappBridge.methods.nativeSendEvent('setPageLevel', { level: 0 });\r\n// \t} else {\r\n// \t\tappBridge.methods.nativeSendEvent('setPageLevel', { level: 1 });\r\n// \t\tgoBack.methods.goBack();\r\n// \t}\r\n// });\r\n\r\n// appBridge.methods.nativeWaitForEvent('deepLink', deepLinkData => {\r\n// \trouter.push(deepLinkData);\r\n// });\r\n\r\nwatch(authToken, () => {\r\n\tconsole.log('watch auth');\r\n\tstore.dispatch('Settings/getEntry');\r\n\tstore.dispatch('Auth/getQuestions', locale.value);\r\n});\r\n\r\nwatch(locale, (newLocale, oldLocale) => {\r\n\tconsole.log('watch locale');\r\n\ti18n.locale.value = newLocale;\r\n\tstore.dispatch('Auth/getQuestions', newLocale);\r\n});\r\n\r\nwatch(nativeData, () => {\r\n\tconsole.log('watch native');\r\n\tconsole.log(entry.value);\r\n\t// if (nativeData.value && entry.value) {\r\n\t// \trouter.push({ name: 'QuestionsView' });\r\n\t// } else if (nativeData.value && !nativeData.value.google_access_token) {\r\n\t// \trouter.push({ name: 'AuthorizationView' });\r\n\t// } else {\r\n\t// \trouter.push({ name: 'HomeView' });\r\n\t// }\r\n});\r\n\r\nasync function clearForGoogleAuth({ commit }) {\r\n\tawait commit('Auth/SET_NATIVE_DATA', null);\r\n}\r\n</script>\r\n<style>\r\n:root {\r\n\t--van-primary-color: rgba(236, 101, 124, 1);\r\n\t--van-background-2: white;\r\n}\r\n\r\n.bg-light {\r\n\tbackground-image: url('@/assets/images/bg-light.png');\r\n}\r\n\r\n.bg-cloud {\r\n\tbackground-image: url('@/assets/images/cloud.png');\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}